<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Srebrne Antosie 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
    }

    header {
      background: linear-gradient(135deg, #b0b0b0, #888);
      color: black;
      padding: 20px;
      text-align: center;
      font-size: 2em;
      font-weight: bold;
    }

    .category {
      padding: 20px;
      border-bottom: 1px solid #333;
    }

    .category h2 {
      margin-bottom: 10px;
      color: #b0b0b0;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .card {
      background: #1a1a1a;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.2s;
      border: 2px solid transparent;
    }

    .card.selected {
      border: 2px solid white;
      background: #333;
    }

    .card.voted {
      opacity: 0.5;
      pointer-events: none;
    }

    video {
      width: 100%;
      border-radius: 8px;
    }

    button {
      margin-top: 10px;
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      background: #b0b0b0;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover:not(:disabled) {
      background: #888;
    }

    button:disabled {
      background: #555;
      cursor: not-allowed;
    }

    .footer {
      text-align: center;
      padding: 20px;
      color: #888;
    }

    #adminPanel {
      display: none;
      padding: 20px;
      background: #111;
    }

    input {
      padding: 8px;
      margin: 5px 0;
      width: 100%;
      border-radius: 5px;
      border: none;
    }

    .result {
      margin-top: 10px;
      background: #222;
      padding: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<header>
   Srebrne Antosie 2025 
</header>

<div id="categories"></div>

<div class="footer">
  Tajny panel: <a href="#" onclick="showLogin()" style="color:#b0b0b0">Admin</a>
</div>

<div id="adminPanel">
  <h2>Panel Admina</h2>
  <div id="results"></div>
  <button onclick="resetVotes()">RESETUJ WSZYSTKIE GOSY</button>
</div>

<script>
const ADMIN_LOGIN = "wronki";
const ADMIN_PASSWORD = "ojciec";

const categories = [
  "Rage Roku (klip)",
  "Smutek (klip)",
  "Modzie偶owe Zdanie (klip)",
  "Zajkanie si (klip)",
  "Gracz Roku (osoba)",
  "Zagranie Roku (klip)",
  "Osoba kt贸ra powinna dotkn trawy (osoba)",
  "Najgorsze Zagranie (klip)",
  "Kierowca Roku (klip)",
  "Porada Roku (klip)"
];

function getVotes() {
  return JSON.parse(localStorage.getItem("votes") || "{}");
}

function saveVotes(votes) {
  localStorage.setItem("votes", JSON.stringify(votes));
}

// Przechowuje, kt贸re kategorie zostay ju偶 zagosowane
let votedCategories = JSON.parse(localStorage.getItem("votedCategories") || "{}");

// Wybrana opcja przed oddaniem gosu
let selectedOption = {};

// Funkcja wyboru karty w kategorii
function selectCard(category, option, cardElement) {
  if (votedCategories[category]) return; // jeli ju偶 zagosowano, nie zmieniaj

  // usu podwietlenie z innych kart w tej kategorii
  const cards = cardElement.parentElement.querySelectorAll(".card");
  cards.forEach(c => c.classList.remove("selected"));

  // zaznacz aktualn kart
  cardElement.classList.add("selected");

  // zapisz tymczasowy wyb贸r
  selectedOption[category] = option;
}

// Funkcja oddania gosu
function vote(category, cardElement) {
  if (votedCategories[category]) return; // ju偶 zagosowano

  const option = selectedOption[category];
  if (!option) {
    alert("Najpierw wybierz klip!");
    return;
  }

  const votes = getVotes();
  if (!votes[category]) votes[category] = {};
  if (!votes[category][option]) votes[category][option] = 0;

  votes[category][option]++;
  saveVotes(votes);

  // zaznacz kategori jako zagosowan
  votedCategories[category] = true;
  localStorage.setItem("votedCategories", JSON.stringify(votedCategories));

  // zablokuj wszystkie karty w kategorii
  const cards = cardElement.parentElement.querySelectorAll(".card");
  cards.forEach(c => c.classList.add("voted"));

  alert("Gos zapisany! ");
}

function render() {
  const container = document.getElementById("categories");

  categories.forEach((cat, index) => {
    const div = document.createElement("div");
    div.className = "category";

    div.innerHTML = `<h2>${index + 1}. ${cat}</h2>
      <div class="grid">
        ${[1,2,3,4].map(i => `
          <div class="card" onclick="selectCard('${cat}', 'Opcja ${i}', this)">
            <video src="klip${index + 1}_${i}.mp4" controls></video>
            <button onclick="event.stopPropagation(); vote('${cat}', this.parentElement)">Gosuj</button>
          </div>
        `).join('')}
      </div>
    `;

    container.appendChild(div);
  });

  // odblokuj/oznacz ju偶 zagosowane kategorie
  for (let cat in votedCategories) {
    if (votedCategories[cat]) {
      const categoryDiv = [...container.children].find(c => c.querySelector("h2").innerText.includes(cat));
      if (categoryDiv) {
        const cards = categoryDiv.querySelectorAll(".card");
        cards.forEach(c => c.classList.add("voted"));
      }
    }
  }
}

function showLogin() {
  const login = prompt("Login:");
  const pass = prompt("Haso:");

  if (login === ADMIN_LOGIN && pass === ADMIN_PASSWORD) {
    document.getElementById("adminPanel").style.display = "block";
    showResults();
  } else {
    alert("Zy login lub haso!");
  }
}

function showResults() {
  const votes = getVotes();
  const results = document.getElementById("results");
  results.innerHTML = "";

  for (let cat in votes) {
    const div = document.createElement("div");
    div.className = "result";

    let html = `<h3>${cat}</h3>`;
    for (let opt in votes[cat]) {
      html += `${opt}: ${votes[cat][opt]} gos贸w<br>`;
    }

    div.innerHTML = html;
    results.appendChild(div);
  }
}

function resetVotes() {
  if (confirm("Na pewno chcesz usun wszystkie gosy?")) {
    localStorage.removeItem("votes");
    localStorage.removeItem("votedCategories");
    votedCategories = {};
    selectedOption = {};
    alert("Gosy zresetowane");
    location.reload();
  }
}

render();
</script>

</body>
</html>
